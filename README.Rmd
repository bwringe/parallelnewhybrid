---
title: "parallelnewhybrid"
author: "Brendan Wringe"
date: "March 1, 2016"
output: html_document
---

### ***parallelnewhybrid*** is an R package designed to parallelize NewHybrids analyses, and can also rapidly create multi-generation simulated hybrid datasets




###Overview of functions: 

**Function name**|**Main use**
------------|----------
**parallelnh_xx.R**| Iteratively assigns NewHybrids analyses to the *c* available cores in a computer.
**nh_zcore.R**| Inserts genotype category assignments to NewHybrids format files (see Anderson XXXX)
**freqbasedsim.R**| Creates simulated hybrid datasets comprised of *two pure parental groups*, *F1*, *F2*, and *backcrosses to both parentals*

###Package Installation
*devtools* must be installed prior to installing **parallelnh**  
With *devtools* installed, **parallelenh** can be installed using the command
```
devtools::install_git("bwringe/parallelnewhybrid")
```
**Note**: **parallelnh** relies on functions from the packages *parallel*, *plyr*, *stringr*, and *tidyr*. The user should ensure these installed prior to installing **parallelnh**

###Function descriptions
####parallelnh_xx.R
Allows NewHybrids (Anderson XXXX) to be run in parallel. It does so by creating a vector of file names to be run, then assigns a job to each of the *c* cores available in the computer. As each task finishes, a new analysis is asigned to the idled core.  
The vector of file names is generated by the function, and will include all NewHybrids format in the folder the user specifies as *folder.data*  
The user can also specify the length of the MCMC burnin using the *burnin* and *sweeps* parameters  
**Note**: There are three operating system-specific versions of the **parallelnh_xx** function because of the different ways in which the operating systems handle forking of processes.  

**parallelnh version**|**operating system**
------------|----------
**parallelnh_OSX** | OS X
**parallelnh_WIN** | Windows
**parallelnh_LINUX** | Linux (Ubuntu)

####nh_zcore.R
The programme NewHybrids allows for individuals to be designated as belonging to a known genotype category to help build the allel frequencies for the various genotype clasess. The function *nh_zcore* will insert a column of known genotype categories (which we call Zvec) into a NewHybrids formatted dataset, then output a NewHybrids format file, with a name indicating that the category vector has been added.  
This can be done for a single file, or for all files in a folder.  
A single Zvec can be applied to all files in a folder in a batch fashion, or each file can be given a unique Zvec.  
For information on the known genotype categories, refer to the NewHybrids documentation. The numbering follows that described in Anderson XXXX (e.g. Pure1 = z0, Pure2 = z1, F1 = z2 etc.).  

####freqbasedsim.R
This function generates simulated, centred Pure1, Pure2, F1, F2, BC1 and BC2 offspring based on the genotype frequencies of two ancestral populations provided in a GENEPOP [link](http://genepop.curtin.edu.au/) formatted file. The user can specify how many simulated files to create, how many individuals to simulate, and how many replicate files to create.  




